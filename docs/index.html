<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>はじめに | がんばらないデータ加工：Rによる繰り返し作業入門（前編）</title>
<meta name="author" content="やわらかクジラ">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="はじめに | がんばらないデータ加工：Rによる繰り返し作業入門（前編）">
<meta property="og:type" content="book">
<meta property="og:image" content="/images/cover.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="はじめに | がんばらないデータ加工：Rによる繰り返し作業入門（前編）">
<meta name="twitter:image" content="/images/cover.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
<meta name="description" content="A book created with bookdown.">
<meta property="og:description" content="A book created with bookdown.">
<meta name="twitter:description" content="A book created with bookdown.">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">がんばらないデータ加工：Rによる繰り返し作業入門（前編）</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="active" href="index.html">はじめに</a></li>
<li><a class="" href="premise.html"><span class="header-section-number">1</span> 前提知識</a></li>
<li><a class="" href="select.html"><span class="header-section-number">2</span> 変数（列）を選ぶ：select( )</a></li>
<li><a class="" href="rename.html"><span class="header-section-number">3</span> 変数名を変更する：rename( )</a></li>
<li><a class="" href="filter.html"><span class="header-section-number">4</span> ケース（行）を選ぶ</a></li>
<li><a class="" href="mutate.html"><span class="header-section-number">5</span> 新しい変数（列）の作成：mutate( )</a></li>
<li><a class="" href="summarise.html"><span class="header-section-number">6</span> 要約値を作る：summarise( )</a></li>
<li><a class="" href="%E3%81%82%E3%81%A8%E3%81%8C%E3%81%8D.html">あとがき</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/izunyan/gisho12.git">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><!--bookdown:title:end--><!--bookdown:title:start--><div id="hajimeni" class="section level1 unnumbered">
<h1>はじめに<a class="anchor" aria-label="anchor" href="#hajimeni"><i class="fas fa-link"></i></a>
</h1>
<p>本書『<strong>Rで読むExcelファイル</strong>』を書こうと思ったのは「RとRStudioを使いたい！と思う人がもっと増えればいいのに」という願いからです。使う人が多くなれば、新しい知識に出会いやすくなりますし、仕事でも使う機会が増える可能性があります。</p>
<p>使う人を増やすためにはよい入門書やwebサイトが必要ですが、それは巷にあふれていて無料でアクセスできるものも多いです。</p>
<p>例えば</p>
<ul>
<li>
<a href="https://r4ds.had.co.nz/">R for Data Science</a>（英語） <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://r4ds.had.co.nz/" class="uri"&gt;https://r4ds.had.co.nz/&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a><br>
</li>
<li>
<a href="https://kazutan.github.io/JSSP2018_spring/index.html">日本社会心理学会　第5回春の方法論セミナー　RとRstudio入門</a> <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://kazutan.github.io/JSSP2018_spring/index.html" class="uri"&gt;https://kazutan.github.io/JSSP2018_spring/index.html&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>
</li>
</ul>
<p>そこで本書では目的を絞って、R（実際はすべてRStudioから使います）を使いたいと思わせる部分を解説することを目指します。Rでどんな便利なことができるか、入門書などでもあまり深く解説されてない部分にフォーカスして紹介します。</p>
<div id="本書の特徴" class="section level2 unnumbered">
<h2>本書の特徴<a class="anchor" aria-label="anchor" href="#%E6%9C%AC%E6%9B%B8%E3%81%AE%E7%89%B9%E5%BE%B4"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>
<p>これまでの解説で不足していること</p>
<ul>
<li>便利な関数や基本的な使い方の解説は多いが，データ加工の実務上知りたいコード例が豊富なわけではない</li>
<li>同じ作業を大量の変数についてくり返し実行したい時のやり方の解説は少ない</li>
</ul>
</li>
<li><p>まずはよくあるモダンなRのデータラングリング解説</p></li>
<li><p>本書の強みは，くり返し同じ作業する部分を効率化したコードを併せて解説する点</p></li>
<li><p>自分の学習経験から，そのコード例が知りたかったんだ！という実用的な方法を収集</p></li>
<li><p>「がんばらない」とは，単純作業のくり返しに無駄なエネルギーを注がなくてよいようにすること</p></li>
<li><p>まず基本の書き方を解説した後に，__【効率化】__でより効率的にコードを書く解説を行う
*【効率化】のタグが本書の核心になる。手作業の繰り返しをなるべく避けることが目指すべき点だからである。</p></li>
<li><p>冗長だが【別解】を示すことで様々な関数の働きを理解でき，データ加工の幅が広がる</p></li>
</ul>
<p>本書の内容は、githubレポジトリの <a href="https://github.com/izunyan/excel_r"></a> ですべて公開しています。コードやサンプルデータはこちらのレポジトリをダウンロードしてお試しください。pdf版が読みたい方は、以下のページで無料で入手可能です。自力でできる方は、<code>Build Book</code>でも作成できます。</p>
<ul>
<li><a href="">技術書典マーケットの販売ページ</a></li>
</ul>
<div id="想定読者" class="section level3 unnumbered">
<h3>想定読者<a class="anchor" aria-label="anchor" href="#%E6%83%B3%E5%AE%9A%E8%AA%AD%E8%80%85"><i class="fas fa-link"></i></a>
</h3>
<p>色々なExcelファイルを読み込んで分析する機会があるのであれば、全くRのことを知らない方から、少しRの経験があるけど複数のファイルを一度に読みこんだことはないというレベルの方ぐらいまでが対象となるでしょう。</p>
<p>本書の到達目標は、RでのExcelファイルの読み書きレベルをある程度高める、という所に定めました。その先は是非好きなように可視化なり解析なり進めていただければと思います。とはいえ、そこでお好きなように！と言われても路頭に迷う方もいるかもしれないので、データの内容把握に関して、要約値や欠損値の一覧、簡単な可視化、相関の一覧についても少しだけ解説しました。その一助として、特別付録として本書と並行してまとめた、可視化のための<a href="https://izunyan.github.io/practice_ggplot2/">ggplot2の辞書</a>（<a href="index.html#huroku">特別付録について</a>参照）もあります。</p>
<p>なお、データをきれいにする過程（例：前処理、データクリーニング、データクレンジング、データラングリングなど）については多くの説明を要するため、本書の範囲を超えます。これはまた別機会にまとめられたらなと思っています。</p>
<p>まず<a href="select.html#select">2</a>章では、RStudioでファイルを読み書きする際に、最低限知っておいた方がよい知識について解説しておきます。とっつきにくいかもしれませんが、知っておいてよかったと後になって実感する類のものなので、使って慣れていきましょう。</p>
<p><a href="filter.html#filter">4</a>章は本書のメインであるExcelファイルの読み込みについて解説します。一つのファイルの読み込みから、複数シート、複数ファイルの読み込みまで、様々なシーンに対応しました。また、読みこんだファイルを一つのデータフレーム<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;変数（列）とオブザベーション（行）が碁盤の目のようになった集まりの形のデータ。Excelであれば通常1行目に列名が入り、2行目以降が個別のデータを表す。データ解析において便利で分かりやすいため、本書ではデータフレームの形で説明していく&lt;/p&gt;"><sup>3</sup></a>にまとめる方法についても触れています。</p>
<p>章はExcelファイルの保存についてです。ここでも、一つのファイルの保存から、複数ファイルの保存まで解説します。ここまでの内容が理解できれば、大量ファイルの読み書きにまつわる単純な繰り返し作業とはさよならできるでしょう。</p>
<p>章は関連知識としてcsvファイルの読み込みと保存について解説します。windowsユーザーは文字コードの違いによる文字化けというつらみと対峙することになり、初学者はここで脱落していくことが多いのではないかと思います。そのために、サバイバルスキルとして知っておくことが有用だと思い書いておきました。自分が相当苦しんだので…</p>
<p>章は、読み込んだファイルの特徴をざっと把握する方法について解説しました。ここまでやれば、（きれいなデータであれば！）きっとデータ解析に入っていくことができるでしょう。</p>
</div>
<div id="前提" class="section level3" number="0.0.1">
<h3>
<span class="header-section-number">0.0.1</span> 前提<a class="anchor" aria-label="anchor" href="#%E5%89%8D%E6%8F%90"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>プロジェクト</li>
<li>%&gt;% tidyverseを読み込めば使える</li>
<li><code><a href="https://dplyr.tidyverse.org/reference/select.html">dplyr::select()</a></code></li>
</ul>
</div>
<div id="執筆環境" class="section level3 unnumbered">
<h3>執筆環境<a class="anchor" aria-label="anchor" href="#%E5%9F%B7%E7%AD%86%E7%92%B0%E5%A2%83"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li><p>本書は<a href="https://bookdown.org/">bookdown</a>にて執筆しました <a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://bookdown.org/" class="uri"&gt;https://bookdown.org/&lt;/a&gt;&lt;/p&gt;'><sup>4</sup></a></p></li>
<li>
<p>RおよびRStudio、パッケージのバージョン</p>
<ul>
<li>R version 3.6.1</li>
<li>RStudio version 1.3.1073</li>
<li>readxl version 1.3.1</li>
<li>tidyverse version 1.3.0</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="注意事項など" class="section level2 unnumbered">
<h2>注意事項など<a class="anchor" aria-label="anchor" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85%E3%81%AA%E3%81%A9"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>本書の内容はすべてwindows環境を想定しています。</p></li>
<li><p>この本に書いてある内容は、筆者が学習したことをまとめているものにすぎないため、正常な動作の保証はできません。使用する際は、自己責任でお願いします。</p></li>
</ul>
</div>
<div id="huroku" class="section level2 unnumbered">
<h2>特別付録について<a class="anchor" aria-label="anchor" href="#huroku"><i class="fas fa-link"></i></a>
</h2>
<p>本書の執筆に先駆けて、順序が違う気がしますがまず付録の作成からはじめました。特別付録は以下でアクセス可能なオンライン付録となります。</p>
<ul>
<li>
<a href="https://izunyan.github.io/practice_ggplot2/">ggplot2の辞書</a>
<ul>
<li><a href="https://izunyan.github.io/practice_ggplot2/" class="uri">https://izunyan.github.io/practice_ggplot2/</a></li>
</ul>
</li>
</ul>
<p>Twitterで応援してもらったら項目が増えていく仕様にしているので、もっと読みたい方は<a href="https://twitter.com/matsuchiy/status/1277621662708453377">こちらのツイート</a>に何らかのレスポンスください！</p>
<hr>
<!-- ![](images/tweet.png)       -->
</div>
</div>

  <div class="chapter-nav">
<div class="empty"></div>
<div class="next"><a href="premise.html"><span class="header-section-number">1</span> 前提知識</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#hajimeni">はじめに</a></li>
<li>
<a class="nav-link" href="#%E6%9C%AC%E6%9B%B8%E3%81%AE%E7%89%B9%E5%BE%B4">本書の特徴</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#%E6%83%B3%E5%AE%9A%E8%AA%AD%E8%80%85">想定読者</a></li>
<li><a class="nav-link" href="#%E5%89%8D%E6%8F%90"><span class="header-section-number">0.0.1</span> 前提</a></li>
<li><a class="nav-link" href="#%E5%9F%B7%E7%AD%86%E7%92%B0%E5%A2%83">執筆環境</a></li>
</ul>
</li>
<li><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85%E3%81%AA%E3%81%A9">注意事項など</a></li>
<li><a class="nav-link" href="#huroku">特別付録について</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/izunyan/gisho12.git/blob/master/index.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/izunyan/gisho12.git/edit/master/index.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>がんばらないデータ加工：Rによる繰り返し作業入門（前編）</strong>" was written by やわらかクジラ. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
